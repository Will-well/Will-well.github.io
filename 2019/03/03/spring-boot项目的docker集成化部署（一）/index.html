<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">

<script>
    (function(){
        if(''){
            if (prompt('请输入文章密码') !== ''){
                alert('密码错误！');
                history.back();
            }
        }
    })();
</script>

<style>
    .pace .pace-progress {
        background: #1E92FB; /*进度条颜色*/
        height: 3px;
    }
    .pace .pace-progress-inner {
         box-shadow: 0 0 10px #1E92FB, 0 0 5px     #1E92FB; /*阴影颜色*/
    }
    .pace .pace-activity {
        border-top-color: #1E92FB;    /*上边框颜色*/
        border-left-color: #1E92FB;    /*左边框颜色*/
    }
</style>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT,Java" />








  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?v=5.1.0" />






<meta name="description" content="spring-boot项目的docker集成化部署[toc] 前言 据说流行的微服务和docker一起，更配哦！接下来，使用简单spring-boot项目演示docker的集成化部署的案例，在看过微笑的博客觉得不过瘾，自己动手，下面的方案与Devops的方式比较接近；希望搭建理解这种思路。  基本思路与方案  开发者push到git服务器 Jenkins通过触发器收到通知 Jenkins克隆工">
<meta property="og:type" content="article">
<meta property="og:title" content="spring-boot项目的docker集成化部署（一）">
<meta property="og:url" content="http://will-we.gitee.io/2019/03/03/spring-boot项目的docker集成化部署（一）/index.html">
<meta property="og:site_name" content="will-well">
<meta property="og:description" content="spring-boot项目的docker集成化部署[toc] 前言 据说流行的微服务和docker一起，更配哦！接下来，使用简单spring-boot项目演示docker的集成化部署的案例，在看过微笑的博客觉得不过瘾，自己动手，下面的方案与Devops的方式比较接近；希望搭建理解这种思路。  基本思路与方案  开发者push到git服务器 Jenkins通过触发器收到通知 Jenkins克隆工">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://user-gold-cdn.xitu.io/2018/10/6/166451caca572083?w=947&h=508&f=png&s=108076">
<meta property="og:image" content="http://user-gold-cdn.xitu.io/2018/10/6/166451caca49acea?w=1312&h=577&f=png&s=120318">
<meta property="og:image" content="https://picture-home-1254026250.cos.ap-beijing.myqcloud.com/img/blog/2018-10-06/修改jenkins的_1538733645_20157.png">
<meta property="og:image" content="https://picture-home-1254026250.cos.ap-beijing.myqcloud.com/img/blog/2018-10-06/登录_1538733778_8467.png">
<meta property="og:image" content="https://picture-home-1254026250.cos.ap-beijing.myqcloud.com/img/blog/2018-10-06/安装推荐插件_1538733819_24609.png">
<meta property="og:image" content="https://picture-home-1254026250.cos.ap-beijing.myqcloud.com/img/blog/2018-10-06/首页_1538733892_31287.png">
<meta property="og:image" content="https://picture-home-1254026250.cos.ap-beijing.myqcloud.com/img/blog/2018-10-06/配置jdk和mave_1538734092_31203.png">
<meta property="og:image" content="https://picture-home-1254026250.cos.ap-beijing.myqcloud.com/img/blog/2018-10-06/日志_1538734522_22024.png">
<meta property="og:image" content="https://picture-home-1254026250.cos.ap-beijing.myqcloud.com/img/blog/2018-10-06/查看docker的镜_1538734566_8524.png">
<meta property="og:image" content="https://picture-home-1254026250.cos.ap-beijing.myqcloud.com/img/blog/2018-10-06/启动日志_1538734731_23737.png">
<meta property="og:image" content="https://picture-home-1254026250.cos.ap-beijing.myqcloud.com/img/blog/2018-10-06/启动docker_1538734598_3294.png">
<meta property="og:image" content="https://picture-home-1254026250.cos.ap-beijing.myqcloud.com/img/blog/2018-10-06/报错日志_1538734777_1374.png">
<meta property="og:image" content="http://user-gold-cdn.xitu.io/2018/10/6/166451cb5888e36f?w=949&h=139&f=png&s=29296">
<meta property="og:image" content="https://picture-home-1254026250.cos.ap-beijing.myqcloud.com/img/blog/2018-10-06/服务器和jenkin_1538734928_8938.png">
<meta property="og:image" content="http://user-gold-cdn.xitu.io/2018/10/6/166451cb6201cac8?w=809&h=305&f=png&s=52097">
<meta property="og:updated_time" content="2019-12-18T16:44:08.401Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="spring-boot项目的docker集成化部署（一）">
<meta name="twitter:description" content="spring-boot项目的docker集成化部署[toc] 前言 据说流行的微服务和docker一起，更配哦！接下来，使用简单spring-boot项目演示docker的集成化部署的案例，在看过微笑的博客觉得不过瘾，自己动手，下面的方案与Devops的方式比较接近；希望搭建理解这种思路。  基本思路与方案  开发者push到git服务器 Jenkins通过触发器收到通知 Jenkins克隆工">
<meta name="twitter:image" content="http://user-gold-cdn.xitu.io/2018/10/6/166451caca572083?w=947&h=508&f=png&s=108076">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://will-we.gitee.io/2019/03/03/spring-boot项目的docker集成化部署（一）/"/>





  <title> spring-boot项目的docker集成化部署（一） | will-well </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">
 
  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">will-well</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <p class="site-subtitle"></p>
    
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-photo">
          <a href="/photo" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-photo"></i> <br />
            
            相册
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://will-we.gitee.io/2019/03/03/spring-boot项目的docker集成化部署（一）/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="weir">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="will-well">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="will-well" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                spring-boot项目的docker集成化部署（一）
              
            
          </h1>
        

        <div class="post-meta">

          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-03T05:59:09+08:00">
                2019-03-02
              </time>
            

            

            
          </span>

          

		  
          
            <span class="post-letters-count">
              &nbsp; | &nbsp;
              <span>1,411 字</span>
              &nbsp; | &nbsp;
              <span>6 min</span>
            </span>
          
		  

          
            
          

          

          
          
             <span id="/2019/03/03/spring-boot项目的docker集成化部署（一）/" class="leancloud_visitors" data-flag-title="spring-boot项目的docker集成化部署（一）">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <script src="\assets\js\APlayer.min.js"> </script><a id="more"></a>
<h1 id="spring-boot项目的docker集成化部署"><a href="#spring-boot项目的docker集成化部署" class="headerlink" title="spring-boot项目的docker集成化部署"></a>spring-boot项目的docker集成化部署</h1><p>[toc]</p>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><blockquote>
<p>据说流行的微服务和docker一起，更配哦！接下来，使用简单spring-boot项目演示docker的集成化部署的案例，在看过微笑的博客觉得不过瘾，自己动手，下面的方案与Devops的方式比较接近；希望搭建理解这种思路。</p>
</blockquote>
<h2 id="基本思路与方案"><a href="#基本思路与方案" class="headerlink" title="基本思路与方案"></a>基本思路与方案</h2><p><img src="http://user-gold-cdn.xitu.io/2018/10/6/166451caca572083?w=947&amp;h=508&amp;f=png&amp;s=108076" alt="docker化的流程图1"></p>
<ol>
<li>开发者<code>push</code>到<code>git服务器</code></li>
<li>Jenkins通过<code>触发器</code>收到通知</li>
<li>Jenkins克隆工作区</li>
<li>Jenkins创建一个Docker镜像（注意：这是用<code>maven的docker插件</code>）</li>
<li>Jenkins将镜像推到Docker Hub<blockquote>
<p>借鉴图片</p>
</blockquote>
</li>
</ol>
<blockquote>
<p><img src="http://user-gold-cdn.xitu.io/2018/10/6/166451caca49acea?w=1312&amp;h=577&amp;f=png&amp;s=120318" alt="docker化的流程图2"></p>
</blockquote>
<h2 id="基本步骤"><a href="#基本步骤" class="headerlink" title="基本步骤"></a>基本步骤</h2><h3 id="准备源码"><a href="#准备源码" class="headerlink" title="准备源码"></a>准备源码</h3><p>Github路径：<a href="https://gitee.com/will-we/spring-boot_docker_demo" target="_blank" rel="external">spring-boot_docker_demo</a></p>
<blockquote>
<p>说明：这里使用com.spotify的docker-maven-plugin的插件；用法参阅代码注释。</p>
</blockquote>
<h3 id="服务器和基础环境"><a href="#服务器和基础环境" class="headerlink" title="服务器和基础环境"></a>服务器和基础环境</h3><h4 id="Linux下Java8安装"><a href="#Linux下Java8安装" class="headerlink" title="Linux下Java8安装"></a>Linux下Java8安装</h4><h5 id="1-下载"><a href="#1-下载" class="headerlink" title="1. 下载"></a>1. 下载</h5><pre><code>wget --no-cookies \
--no-check-certificate \
--header &quot;Cookie: oraclelicense=accept-securebackup-cookie&quot; \
http://download.oracle.com/otn-pub/java/jdk/8u181-b13/96a7b8442fe848ef90c96a2fad6ed6d1/jdk-8u181-linux-x64.tar.gz \
-O jdk-8-linux-x64.tar.gz
</code></pre><h5 id="2-解压安装"><a href="#2-解压安装" class="headerlink" title="2. 解压安装"></a>2. 解压安装</h5><pre><code>tar -zxvf jdk-8-linux-x64.tar.gz
mv jdk-8-linux-x64.tar.gz /usr/local
</code></pre><h5 id="3-配置环境变量"><a href="#3-配置环境变量" class="headerlink" title="3. 配置环境变量"></a>3. 配置环境变量</h5><pre><code>export JAVA_HOME=/usr/local/jdk1.8.0_181/
export PATH=$PATH:$JAVA_HOME
export JAVA_HOME=/usr/local/jdk1.8.0_181/
export JRE_HOME=$JAVA_HOME/jre                 #tomcat需要
export CLASSPATH=.:$JAVA_HOME/lib:$JRE_HOME/lib
export PATH=$JAVA_HOME/bin:$JRE_HOME/bin:$PATH
</code></pre><h5 id="4-刷新环境变量"><a href="#4-刷新环境变量" class="headerlink" title="4. 刷新环境变量"></a>4. 刷新环境变量</h5><pre><code>source  /etc/profile #刷新环境变量
2.1.3.2.3    Linux下Manven安装 
</code></pre><h4 id="maven的安装"><a href="#maven的安装" class="headerlink" title="maven的安装"></a>maven的安装</h4><h5 id="1-下载maven"><a href="#1-下载maven" class="headerlink" title="1. 下载maven"></a>1. 下载maven</h5><pre><code>wget http://mirrors.cnnic.cn/apache/maven/maven-3/3.5.0/binaries/apache-maven-3.5.0-bin.tar.gz
</code></pre><h5 id="2-安装"><a href="#2-安装" class="headerlink" title="2.  安装"></a>2.  安装</h5><pre><code>tar -zxvf apache-maven-3.5.0-bin.tar.gz
mv apache-maven-3.5.4 /usr/local/maven/apache-maven-3.5.4
</code></pre><h5 id="3-配置环境变量-1"><a href="#3-配置环境变量-1" class="headerlink" title="3. 配置环境变量"></a>3. 配置环境变量</h5><pre><code>export MAVEN_HOME=/usr/local/maven/apache-maven-3.5.4
export PATH=$JAVA_HOME/bin:$JRE_HOME/bin:$MAVEN_HOME/bin:$PATH #注意这里添加$MAVEN_HOME/bin
</code></pre><h5 id="4-刷新环境变量-1"><a href="#4-刷新环境变量-1" class="headerlink" title="4. 刷新环境变量"></a>4. 刷新环境变量</h5><pre><code>source  /etc/profile #刷新环境变量
</code></pre><h4 id="安装Jenkins"><a href="#安装Jenkins" class="headerlink" title="安装Jenkins"></a>安装Jenkins</h4><blockquote>
<p>Jenkins安装有三种方式</p>
<h5 id="1-基于Docker的安装"><a href="#1-基于Docker的安装" class="headerlink" title="1. 基于Docker的安装"></a>1. 基于Docker的安装</h5><pre><code>docker run \
  -u root \
  --rm \
  -d \
  -p 8080:8080 \
  -p 50000:50000 \
  -v jenkins-data:/var/jenkins_home \
  -v /var/run/docker.sock:/var/run/docker.sock \
  jenkinsci/blueocean
</code></pre><h5 id="2-基于war包方式"><a href="#2-基于war包方式" class="headerlink" title="2. 基于war包方式"></a>2. 基于war包方式</h5><p>在官网下载，放入Tomcat的目录中即可；打war，大家肯定十分熟悉的操作。</p>
</blockquote>
<h5 id="3-使用yum方式直接安装-（推荐）"><a href="#3-使用yum方式直接安装-（推荐）" class="headerlink" title="3. 使用yum方式直接安装 （推荐）"></a>3. 使用yum方式直接安装 （推荐）</h5><h6 id="1-下载-1"><a href="#1-下载-1" class="headerlink" title="1.下载"></a>1.下载</h6><pre><code>sudo wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat-stable/jenkins.repo 
sudo rpm --import https://pkg.jenkins.io/redhat-stable/jenkins.io.key  
</code></pre><h6 id="2-安装-1"><a href="#2-安装-1" class="headerlink" title="2.安装"></a>2.安装</h6><pre><code>yum install jenkins
</code></pre><h6 id="3-配置"><a href="#3-配置" class="headerlink" title="3. 配置"></a>3. 配置</h6><pre><code>vi /etc/sysconfig/jenkins
</code></pre><p><img src="https://picture-home-1254026250.cos.ap-beijing.myqcloud.com/img/blog/2018-10-06/修改jenkins的_1538733645_20157.png" alt="修改Jenkins的配置端口和登录用户"></p>
<blockquote>
<p>可避免避免和<code>Tomcat</code>端口重复的问题</p>
</blockquote>
<h6 id="4-启动服务"><a href="#4-启动服务" class="headerlink" title="4. 启动服务"></a>4. 启动服务</h6><pre><code>service jenkins start
</code></pre><h5 id="Jenkins的基本初始化"><a href="#Jenkins的基本初始化" class="headerlink" title="Jenkins的基本初始化"></a>Jenkins的基本初始化</h5><h6 id="1-登录"><a href="#1-登录" class="headerlink" title="1. 登录"></a>1. 登录</h6><p><img src="https://picture-home-1254026250.cos.ap-beijing.myqcloud.com/img/blog/2018-10-06/登录_1538733778_8467.png" alt="登录"></p>
<h6 id="2-安装Jenkins插件"><a href="#2-安装Jenkins插件" class="headerlink" title="2. 安装Jenkins插件"></a>2. 安装Jenkins插件</h6><p><img src="https://picture-home-1254026250.cos.ap-beijing.myqcloud.com/img/blog/2018-10-06/安装推荐插件_1538733819_24609.png" alt="安装推荐插件"></p>
<h6 id="3-安装成功"><a href="#3-安装成功" class="headerlink" title="3.安装成功"></a>3.安装成功</h6><blockquote>
<p>基本按照推荐来<br><img src="https://picture-home-1254026250.cos.ap-beijing.myqcloud.com/img/blog/2018-10-06/首页_1538733892_31287.png" alt="首页"></p>
</blockquote>
<h6 id="4-配置jdk和maven配置"><a href="#4-配置jdk和maven配置" class="headerlink" title="4. 配置jdk和maven配置"></a>4. 配置jdk和maven配置</h6><p><img src="https://picture-home-1254026250.cos.ap-beijing.myqcloud.com/img/blog/2018-10-06/配置jdk和mave_1538734092_31203.png" alt="配置jdk和maven"></p>
<blockquote>
<p>说明这里其实<code>git</code>非必须，之前的插件安装中安装了</p>
</blockquote>
<h5 id="Pipeline语法"><a href="#Pipeline语法" class="headerlink" title="Pipeline语法"></a>Pipeline语法</h5><blockquote>
<p>语法请自行查阅资料，这里使用groovy的语法    </p>
<ul>
<li><a href="https://testerhome.com/topics/10033" target="_blank" rel="external">devops [持续交付实践] pipeline：pipeline 使用之语法详解</a></li>
<li><a href="https://jenkins.io/doc/book/pipeline/" target="_blank" rel="external">Jenkins语法</a></li>
</ul>
</blockquote>
<h5 id="Jenkins的项目配置"><a href="#Jenkins的项目配置" class="headerlink" title="Jenkins的项目配置"></a>Jenkins的项目配置</h5><h6 id="1-新建pipeline的项目"><a href="#1-新建pipeline的项目" class="headerlink" title="1. 新建pipeline的项目"></a>1. 新建pipeline的项目</h6><h6 id="2-添加如下jekins的脚本内容：注意：使用pipeline的语言"><a href="#2-添加如下jekins的脚本内容：注意：使用pipeline的语言" class="headerlink" title="2. 添加如下jekins的脚本内容：注意：使用pipeline的语言"></a>2. 添加如下jekins的脚本内容：注意：使用pipeline的语言</h6><pre><code>#!groovy
pipeline{
    agent any

    environment {
        REPOSITORY=&quot;https://gitee.com/will-we/spring-boot_docker_demo.git&quot;
    }
    tools {
        maven &apos;m3&apos;
        jdk &apos;java8&apos;
    }
    stages {
        stage(&apos;获取代码&apos;){
            steps {
                echo &quot;start fetch code from git:${REPOSITORY}&quot;
                //清空当前目录
                deleteDir()
                //拉去代码    
                git &quot;${REPOSITORY}&quot;
            }
        }
        stage(&apos;代码静态检查&apos;){
            steps {
                //伪代码检查
                echo &quot;start code check&quot;
            }
        }        
        stage(&apos;编译+单元测试&apos;){
            steps {
                echo &quot;start compile&quot;
                //切换目录
                sh &apos;mvn -Dmaven.test.skip=true -U clean install&apos;
            }
        }
        stage(&apos;构建镜像&apos;){
            steps {
                echo &quot;start build image&quot;
                //build镜像
                sh &apos;mvn clean package docker:build&apos;
            }
        }
    }
}
</code></pre><h6 id="3-立即构建”，查看运行的日子如下："><a href="#3-立即构建”，查看运行的日子如下：" class="headerlink" title="3.  立即构建”，查看运行的日子如下："></a>3.  立即构建”，查看运行的日子如下：</h6><p> <img src="https://picture-home-1254026250.cos.ap-beijing.myqcloud.com/img/blog/2018-10-06/日志_1538734522_22024.png" alt="日志"></p>
<h6 id="4-如果看上面的恭喜你，构建镜像成功；参看docker的镜像，对你“so-easy”"><a href="#4-如果看上面的恭喜你，构建镜像成功；参看docker的镜像，对你“so-easy”" class="headerlink" title="4.  如果看上面的恭喜你，构建镜像成功；参看docker的镜像，对你“so easy”"></a>4.  如果看上面的恭喜你，构建镜像成功；参看docker的镜像，对你“so easy”</h6><p> <img src="https://picture-home-1254026250.cos.ap-beijing.myqcloud.com/img/blog/2018-10-06/查看docker的镜_1538734566_8524.png" alt="查看docker的镜像"></p>
<h6 id="5-启动docker容器"><a href="#5-启动docker容器" class="headerlink" title="5. 启动docker容器"></a>5. 启动docker容器</h6><pre><code># 最好添加--name参数
docker run --name= springboot/spring-boot_docker_demo -p 8081:8080 -t srping-demo
</code></pre><p><img src="https://picture-home-1254026250.cos.ap-beijing.myqcloud.com/img/blog/2018-10-06/启动日志_1538734731_23737.png" alt="启动日志"><br><img src="https://picture-home-1254026250.cos.ap-beijing.myqcloud.com/img/blog/2018-10-06/启动docker_1538734598_3294.png" alt="启动docker"></p>
<h4 id="问题解决"><a href="#问题解决" class="headerlink" title="问题解决"></a>问题解决</h4><h5 id="1-Jenkins构建时出现：“mvn-command-not-found”"><a href="#1-Jenkins构建时出现：“mvn-command-not-found”" class="headerlink" title="1. Jenkins构建时出现：“mvn: command not found”"></a>1. Jenkins构建时出现：“mvn: command not found”</h5><p> <img src="https://picture-home-1254026250.cos.ap-beijing.myqcloud.com/img/blog/2018-10-06/报错日志_1538734777_1374.png" alt="报错日志"><br>解决方案：</p>
<blockquote>
<p>自己试着摸着石头过河，只能借助搜索引擎了；如下是解决的流程：</p>
</blockquote>
<p>1）    安装Pipeline Maven Integration插件<br> <img src="http://user-gold-cdn.xitu.io/2018/10/6/166451cb5888e36f?w=949&amp;h=139&amp;f=png&amp;s=29296" alt=""><br>2）    检查环境变量</p>
<blockquote>
<p>上面安装了插件后依旧不好使，继续找原因吧，Maven not found in Jenkins【StackOverflow】有着这个题问题：原因如下：<br>The reason is that Jenkins is installed and run as a ‚system user‘ service. This means the process can‘t see the ENV variables and PATH of your user (user level). Setting up maven in PATH and ENV variables on system level makes the trick.<br>大体意思是：jekins的无法读取系统的环境变量；于是分别查看了大致的服务器和jekins的变量。<br>Jenkins    服务器/bin/bash</p>
</blockquote>
<p><img src="https://picture-home-1254026250.cos.ap-beijing.myqcloud.com/img/blog/2018-10-06/服务器和jenkin_1538734928_8938.png" alt="服务器和Jenkins的对比"></p>
<p>3）    Jenkins导入java和maven的权限</p>
<blockquote>
<p>还记得之前配置Jdk和maven的“全局工具设置”，注意：这里设置也是依旧不能直接读取，需要如下方式引入；“m3”是配置时名称，“java8”也是配置名称。</p>
</blockquote>
<pre><code>tools {
    maven &apos;m3&apos;
    jdk &apos;java8&apos;
}
</code></pre><p><img src="http://user-gold-cdn.xitu.io/2018/10/6/166451cb6201cac8?w=809&amp;h=305&amp;f=png&amp;s=52097" alt=""></p>
<h5 id="2-Linux中端口占用问题"><a href="#2-Linux中端口占用问题" class="headerlink" title="2. Linux中端口占用问题"></a>2. Linux中端口占用问题</h5><pre><code>#方式一：参看端口8080信息
netstat -lnp | grep 8080
#方式二：参看端口8080信息
lsof -i :808
#杀死进程
kill -9 pid号
</code></pre><h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><h3 id="1-本文总结："><a href="#1-本文总结：" class="headerlink" title="1. 本文总结："></a>1. 本文总结：</h3><blockquote>
<p>我们使用了一个简单的<code>spring-boot</code>项目部署到远程服务器的操作流程，从而实现了推送代码到Git远程仓库，使用jekins的集成化构建docker实现，自动化部署方式。</p>
</blockquote>
<h3 id="2-后期优化："><a href="#2-后期优化：" class="headerlink" title="2. 后期优化："></a>2. 后期优化：</h3><blockquote>
<p>演示spring-boot的简单部署方式，其实该项目的还有很多地方优化，例如：<code>doker push</code>docker的仓库、使用<code>Jenkins</code>的触发器<code>git hook</code>等；以及后期；spring-boot的多模块、以及<code>docker compose</code>的使用等。由于篇幅的原因可能放在了后面的文章。</p>
</blockquote>
<hr>
<p>参考资料</p>
<ul>
<li><a href="http://niocoder.com/2018/04/22/SpringBoot+Docker+Git+Jenkins%E5%AE%9E%E7%8E%B0%E7%AE%80%E6%98%93%E7%9A%84%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E5%92%8C%E9%83%A8%E7%BD%B2/" target="_blank" rel="external">SpringBoot+Docker+Git+Jenkins实现简易的持续集成和持续部署</a></li>
<li><a href="http://blog.51cto.com/ityouknow/2088355" target="_blank" rel="external">Spring Boot 2.0(四)：使用 Docker 部署 Spring Boot</a><a href="https://blog.csdn.net/aixiaoyang168/article/details/77453974" target="_blank" rel="external">Maven 插件之 docker-maven-plugin 的使用</a></li>
<li><a href="http://dockone.io/article/1735" target="_blank" rel="external">部署流水线搭建小记：Docker、Jenkins、Java和Couchbase</a></li>
</ul>
<p><strong>================================================================================</strong></p>
<ul>
<li>个人博客：<a href="will-we.com">will-we.com</a></li>
<li>我的掘金：<a href="https://juejin.im/user/5a63058b518825732646e4ed" target="_blank" rel="external">weir</a></li>
<li>我的简书：<a href="https://www.jianshu.com/u/26b9661e9e78" target="_blank" rel="external">weir</a></li>
</ul>
<p><strong>================================================================================</strong></p>

      
    </div>
	
	<div>
	  
		  <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>
	  
	</div>
	
	<div>
      
        
      
	</div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>
	


    <footer class="post-footer">
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/05/06/01-Http、Https、Http2-0-的基础知识总结（持续更新篇）/" rel="next" title="01_Http、Https、Http2.0 的基础知识总结（持续更新篇）">
                <i class="fa fa-chevron-left"></i> 01_Http、Https、Http2.0 的基础知识总结（持续更新篇）
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

          
          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="uyan_frame"></div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.png"
               alt="weir" />
          <p class="site-author-name" itemprop="name">weir</p>
          <p class="site-description motion-element" itemprop="description">will we？will be well；this is weir.</p>
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">13</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">8</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">10</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/Will-well" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#spring-boot项目的docker集成化部署"><span class="nav-number">1.</span> <span class="nav-text">spring-boot项目的docker集成化部署</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#前言"><span class="nav-number">1.1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基本思路与方案"><span class="nav-number">1.2.</span> <span class="nav-text">基本思路与方案</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基本步骤"><span class="nav-number">1.3.</span> <span class="nav-text">基本步骤</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#准备源码"><span class="nav-number">1.3.1.</span> <span class="nav-text">准备源码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#服务器和基础环境"><span class="nav-number">1.3.2.</span> <span class="nav-text">服务器和基础环境</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Linux下Java8安装"><span class="nav-number">1.3.2.1.</span> <span class="nav-text">Linux下Java8安装</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-下载"><span class="nav-number">1.3.2.1.1.</span> <span class="nav-text">1. 下载</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-解压安装"><span class="nav-number">1.3.2.1.2.</span> <span class="nav-text">2. 解压安装</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-配置环境变量"><span class="nav-number">1.3.2.1.3.</span> <span class="nav-text">3. 配置环境变量</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-刷新环境变量"><span class="nav-number">1.3.2.1.4.</span> <span class="nav-text">4. 刷新环境变量</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#maven的安装"><span class="nav-number">1.3.2.2.</span> <span class="nav-text">maven的安装</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-下载maven"><span class="nav-number">1.3.2.2.1.</span> <span class="nav-text">1. 下载maven</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-安装"><span class="nav-number">1.3.2.2.2.</span> <span class="nav-text">2.  安装</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-配置环境变量-1"><span class="nav-number">1.3.2.2.3.</span> <span class="nav-text">3. 配置环境变量</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-刷新环境变量-1"><span class="nav-number">1.3.2.2.4.</span> <span class="nav-text">4. 刷新环境变量</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#安装Jenkins"><span class="nav-number">1.3.2.3.</span> <span class="nav-text">安装Jenkins</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-基于Docker的安装"><span class="nav-number">1.3.2.3.1.</span> <span class="nav-text">1. 基于Docker的安装</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-基于war包方式"><span class="nav-number">1.3.2.3.2.</span> <span class="nav-text">2. 基于war包方式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-使用yum方式直接安装-（推荐）"><span class="nav-number">1.3.2.3.3.</span> <span class="nav-text">3. 使用yum方式直接安装 （推荐）</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#1-下载-1"><span class="nav-number">1.3.2.3.3.1.</span> <span class="nav-text">1.下载</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2-安装-1"><span class="nav-number">1.3.2.3.3.2.</span> <span class="nav-text">2.安装</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-配置"><span class="nav-number">1.3.2.3.3.3.</span> <span class="nav-text">3. 配置</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#4-启动服务"><span class="nav-number">1.3.2.3.3.4.</span> <span class="nav-text">4. 启动服务</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Jenkins的基本初始化"><span class="nav-number">1.3.2.3.4.</span> <span class="nav-text">Jenkins的基本初始化</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#1-登录"><span class="nav-number">1.3.2.3.4.1.</span> <span class="nav-text">1. 登录</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2-安装Jenkins插件"><span class="nav-number">1.3.2.3.4.2.</span> <span class="nav-text">2. 安装Jenkins插件</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-安装成功"><span class="nav-number">1.3.2.3.4.3.</span> <span class="nav-text">3.安装成功</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#4-配置jdk和maven配置"><span class="nav-number">1.3.2.3.4.4.</span> <span class="nav-text">4. 配置jdk和maven配置</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Pipeline语法"><span class="nav-number">1.3.2.3.5.</span> <span class="nav-text">Pipeline语法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Jenkins的项目配置"><span class="nav-number">1.3.2.3.6.</span> <span class="nav-text">Jenkins的项目配置</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#1-新建pipeline的项目"><span class="nav-number">1.3.2.3.6.1.</span> <span class="nav-text">1. 新建pipeline的项目</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2-添加如下jekins的脚本内容：注意：使用pipeline的语言"><span class="nav-number">1.3.2.3.6.2.</span> <span class="nav-text">2. 添加如下jekins的脚本内容：注意：使用pipeline的语言</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-立即构建”，查看运行的日子如下："><span class="nav-number">1.3.2.3.6.3.</span> <span class="nav-text">3.  立即构建”，查看运行的日子如下：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#4-如果看上面的恭喜你，构建镜像成功；参看docker的镜像，对你“so-easy”"><span class="nav-number">1.3.2.3.6.4.</span> <span class="nav-text">4.  如果看上面的恭喜你，构建镜像成功；参看docker的镜像，对你“so easy”</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#5-启动docker容器"><span class="nav-number">1.3.2.3.6.5.</span> <span class="nav-text">5. 启动docker容器</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#问题解决"><span class="nav-number">1.3.2.4.</span> <span class="nav-text">问题解决</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-Jenkins构建时出现：“mvn-command-not-found”"><span class="nav-number">1.3.2.4.1.</span> <span class="nav-text">1. Jenkins构建时出现：“mvn: command not found”</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-Linux中端口占用问题"><span class="nav-number">1.3.2.4.2.</span> <span class="nav-text">2. Linux中端口占用问题</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#结语"><span class="nav-number">1.4.</span> <span class="nav-text">结语</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-本文总结："><span class="nav-number">1.4.1.</span> <span class="nav-text">1. 本文总结：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-后期优化："><span class="nav-number">1.4.2.</span> <span class="nav-text">2. 后期优化：</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2015 - 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">weir</span>
</div>



<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共18.8k字</span>
</div>
        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  
      
  

  
      <!-- UY BEGIN -->
      <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2129962"></script>
      <!-- UY END -->
  




  
  

  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("0zS8rNs7ve9eIJxVc3qJjie1-gzGzoHsz", "aESjRj3ls3aaiXIs017T2I6T");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  


  <!-- 添加鼠标移动动态效果 -->
  <script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
  <!-- 页面点击小红心 -->
  <script type="text/javascript" src="/js/src/love.js"></script>


</body>
</html>
